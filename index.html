<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¨Ù‚Ø§Ù„ÙŠØ© Ø£Ø¨Ùˆ Ø­Ù…Ø²Ø©</title>

<style>
body{
 margin:0;
 font-family:Tahoma, Arial;
 background:#f2fdf9;
 padding-bottom:180px;
}

header img{
 width:100%;
 border-radius:0 0 20px 20px;
}

.search{
 padding:10px;
}
.search input{
 width:100%;
 padding:12px;
 border-radius:14px;
 border:1px solid #ccc;
 font-size:16px;
}

.products{
 padding:10px;
 display:grid;
 grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
 gap:12px;
}

.card{
 background:#fff;
 border-radius:16px;
 padding:10px;
 text-align:center;
 box-shadow:0 4px 10px rgba(0,0,0,.1);
}

.card img{
 width:100%;
 height:120px;
 object-fit:cover;
 border-radius:12px;
 background:#eee;
}

.card h4{margin:6px 0 2px}
.card p{margin:0;color:#444}

.qty{
 display:flex;
 justify-content:center;
 gap:10px;
 margin:6px 0;
}
.qty button{
 width:30px;height:30px;
 border:none;border-radius:50%;
 background:#0f766e;color:#fff;font-size:18px;
}

.card button{
 width:100%;
 padding:8px;
 border:none;
 border-radius:10px;
 background:#0f766e;
 color:#fff;
}

.cart{
 position:fixed;
 bottom:0;left:0;right:0;
 background:#fff;
 padding:10px;
 border-top:2px solid #0f766e;
}

.total{
 color:red;
 font-weight:bold;
 margin-bottom:4px;
}

.whatsapp{
 width:100%;
 padding:14px;
 background:#25D366;
 border:none;
 border-radius:14px;
 font-size:18px;
 color:#fff;
}

.cart-icon{
 position:fixed;
 top:10px;
 left:10px;
 background:#0f766e;
 color:#fff;
 width:45px;
 height:45px;
 border-radius:50%;
 display:flex;
 align-items:center;
 justify-content:center;
 font-size:22px;
 z-index:10;
}

.cart-count{
 position:absolute;
 top:-6px;
 right:-6px;
 background:red;
 color:#fff;
 width:22px;
 height:22px;
 border-radius:50%;
 font-size:14px;
 display:flex;
 align-items:center;
 justify-content:center;
}
</style>
</head>

<body>

<div class="cart-icon">
 ğŸ§º
 <div class="cart-count" id="cartCount">0</div>
</div>

<header>
 <img src="./banner.jpg" alt="Ø£Ø¨Ùˆ Ø­Ù…Ø²Ø©">
</header>

<div class="search">
 <input id="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬ ğŸ”">
</div>

<div class="products" id="products"></div>

<div class="cart">
 <div class="total" id="total">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: 0 Ø¯ÙŠÙ†Ø§Ø±</div>
 <div class="total">Ø³Ø¹Ø± Ø§Ù„ØªÙˆØµÙŠÙ„: 1000 Ø¯ÙŠÙ†Ø§Ø±</div>
 <button class="whatsapp" onclick="send()">ğŸ“² Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
</div>

<script>
const phoneTrader="9647700957240";
const delivery=1000;

let products=[];
let cart=[];
let weights={};

const box=document.getElementById("products");
const search=document.getElementById("search");

fetch("https://opensheet.elk.sh/1VDPFkYkKQUfPNtU7xneBxUyYObotJtip5FdK42KCqzE/Sheet1")
.then(res=>res.json())
.then(data=>{
 products=data;
 render();
});

search.oninput=render;

function render(){
 box.innerHTML="";

 products
 .filter(p => p.name.includes(search.value.trim()))
 .forEach((p,i)=>{

  if(!weights[i]) weights[i]=1;

  box.innerHTML+=`
  <div class="card">
   <img src="./${p.img}.jpg" alt="${p.name}">
   <h4>${p.name}</h4>
   <p>${p.price} Ø¯ÙŠÙ†Ø§Ø± / ÙƒØºÙ…</p>

   <div class="qty">
    <button onclick="change(${i},-0.5)">âˆ’</button>
    <b id="w${i}">${weights[i]}</b>
    <button onclick="change(${i},0.5)">+</button>
   </div>

   <button onclick="add(${i})">Ø¥Ø¶Ø§ÙØ©</button>
  </div>
  `;
 });
}

function change(i,v){
 weights[i]=Math.max(0.5,weights[i]+v);
 document.getElementById("w"+i).innerText=weights[i];
}

function add(i){
 cart.push({
  name:products[i].name,
  price:+products[i].price,
  w:weights[i]
 });
 updateCart();
}

function updateCart(){
 let sum=0;
 cart.forEach(c=>sum+=c.price*c.w);
 document.getElementById("total").innerText=
  "Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: "+(sum+delivery)+" Ø¯ÙŠÙ†Ø§Ø±";
 document.getElementById("cartCount").innerText=cart.length;
}

function send(){
 if(!cart.length){
  alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©");
  return;
 }
 let msg="ğŸ§¾ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯\n";
 let sum=0;
 cart.forEach((c,i)=>{
  let cost=c.price*c.w;
  sum+=cost;
  msg+=`${i+1}- ${c.name} ${c.w}ÙƒØºÙ… = ${cost} Ø¯ÙŠÙ†Ø§Ø±\n`;
 });
 msg+=`------------------\nØ§Ù„ØªÙˆØµÙŠÙ„: ${delivery}\nØ§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${sum+delivery}`;
 location.href="https://wa.me/"+phoneTrader+"?text="+encodeURIComponent(msg);
}
</script>

</body>
</html>